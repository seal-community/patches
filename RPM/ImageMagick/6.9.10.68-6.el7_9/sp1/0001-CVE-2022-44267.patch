From 05673e63c919e61ffa1107804d1138c46547a475 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Sat, 22 Oct 2022 13:28:46 -0400
Subject: [PATCH 1/1] Seal Security Hotfix for ImageMagick 6.9.10.68-6.el7_9

This patch fixes:
  CVE-2022-44267

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://git.centos.org/rpms/ImageMagick/tree/0ed14eb7d986359f7d0dea632d6a048142b8ed75
---
 coders/png.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/coders/png.c b/coders/png.c
index ee6fba2..9f23804 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -3789,7 +3789,8 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
                   key[MaxTextExtent];
 
                 (void) FormatLocaleString(key,MaxTextExtent,"%s",text[i].key);
-                if (LocaleCompare(key,"version") == 0)
+                if ((LocaleCompare(key,"version") == 0) ||
+                    (LocaleCompare(key,"profile") == 0))
                   (void) FormatLocaleString(key,MagickPathExtent,"png:%s",
                     text[i].key);
                 (void) SetImageProperty(image,key,value);
