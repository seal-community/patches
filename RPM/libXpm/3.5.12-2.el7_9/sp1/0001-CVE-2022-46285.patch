From a3a7c6dcc3b629d765014816c566c63165c63ca8 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Sat, 17 Dec 2022 12:23:45 -0800
Subject: [PATCH 1/2] Seal Security Hotfix for libXpm 3.5.12-2.el7_9

This patch fixes:
  CVE-2022-46285

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://git.centos.org/rpms/libXpm/tree/55b2c28d31ae54f5f2e1a67e88dfbf11c3e0e374
---
 src/data.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/data.c b/src/data.c
index 898889c..bfad4ff 100644
--- a/src/data.c
+++ b/src/data.c
@@ -174,6 +174,10 @@ ParseComment(xpmData *data)
 		notend = 0;
 		Ungetc(data, *s, file);
 	    }
+	    else if (c == EOF) {
+		/* hit end of file before the end of the comment */
+		return XpmFileInvalid;
+	    }
 	}
 	return 0;
     }
-- 
GitLab

