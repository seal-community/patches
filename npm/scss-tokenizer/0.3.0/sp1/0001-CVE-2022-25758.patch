From c8ceec564cb00596ba542402fb7dd8a54ebdf699 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Tue, 31 Oct 2023 20:47:24 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for scss-tokenizer 0.3.0

This patch fixes:
  CVE-2022-25758

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/sasstools/scss-tokenizer/tree/v0.3.0
---
 src/previous-map.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/previous-map.js b/src/previous-map.js
index 24c7a42..406c0bf 100644
--- a/src/previous-map.js
+++ b/src/previous-map.js
@@ -31,7 +31,7 @@ export default class PreviousMap {
     }
 
     loadAnnotation(css) {
-        let match = css.match(/\/\*\s*# sourceMappingURL=(.*)\s*\*\//);
+        let match = css.match(/\/\*\s*# sourceMappingURL=((?:(?!sourceMappingURL=).)*)\s*\*\//);
         if ( match ) this.annotation = match[1].trim();
     }
 
-- 


