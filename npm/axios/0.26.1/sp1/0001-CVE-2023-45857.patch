From ebe8a60e8e3db6444cb2240f4d33e4d05a5be646 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Mon, 30 Oct 2023 17:36:38 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for axios 0.26.1

This patch fixes:
  CVE-2023-45857

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/axios/axios/tree/170588f3d78f855450d1ce50968651a54cda7386
---
 lib/adapters/xhr.js        | 3 ++-
 test/specs/xsrf.spec.js    | 4 ++--
 test/unit/adapters/http.js | 2 +-
 3 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/lib/adapters/xhr.js b/lib/adapters/xhr.js
index 1fe7be3..28b3eca 100644
--- a/lib/adapters/xhr.js
+++ b/lib/adapters/xhr.js
@@ -146,7 +146,8 @@ module.exports = function xhrAdapter(config) {
     // Specifically not if we're in a web worker, or react-native.
     if (utils.isStandardBrowserEnv()) {
       // Add xsrf header
-      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?
+      // regarding CVE-2023-45857 config.withCredentials condition was removed temporarily
+      var xsrfValue = isURLSameOrigin(fullPath) && config.xsrfCookieName ?
         cookies.read(config.xsrfCookieName) :
         undefined;
 
diff --git a/test/specs/xsrf.spec.js b/test/specs/xsrf.spec.js
index 56cc0d2..b0480bc 100644
--- a/test/specs/xsrf.spec.js
+++ b/test/specs/xsrf.spec.js
@@ -67,7 +67,7 @@ describe('xsrf', function () {
     });
   });
 
-  it('should set xsrf header for cross origin when using withCredentials', function (done) {
+  it('should not set xsrf header for cross origin when using withCredentials', function (done) {
     document.cookie = axios.defaults.xsrfCookieName + '=12345';
 
     axios('http://example.com/', {
@@ -75,7 +75,7 @@ describe('xsrf', function () {
     });
 
     getAjaxRequest().then(function (request) {
-      expect(request.requestHeaders[axios.defaults.xsrfHeaderName]).toEqual('12345');
+      expect(request.requestHeaders[axios.defaults.xsrfHeaderName]).toEqual(undefined);
       done();
     });
   });
-- 


