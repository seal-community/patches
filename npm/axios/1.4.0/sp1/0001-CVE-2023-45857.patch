From 65b12bd071f39f01bbc230d27cfdc425c6841d9f Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Thu, 26 Oct 2023 21:54:06 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for axios 1.4.0

This patch fixes:
  CVE-2023-45857

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/axios/axios/tree/v1.4.0
---
 lib/adapters/xhr.js     | 4 ++--
 test/specs/xsrf.spec.js | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/lib/adapters/xhr.js b/lib/adapters/xhr.js
index 18b39f2..7864b48 100644
--- a/lib/adapters/xhr.js
+++ b/lib/adapters/xhr.js
@@ -188,8 +188,8 @@ export default isXHRAdapterSupported && function (config) {
     // Specifically not if we're in a web worker, or react-native.
     if (platform.isStandardBrowserEnv) {
       // Add xsrf header
-      const xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath))
-        && config.xsrfCookieName && cookies.read(config.xsrfCookieName);
+      // regarding CVE-2023-45857 config.withCredentials condition was removed temporarily
+      const xsrfValue = isURLSameOrigin(fullPath) && config.xsrfCookieName && cookies.read(config.xsrfCookieName);
 
       if (xsrfValue) {
         requestHeaders.set(config.xsrfHeaderName, xsrfValue);
diff --git a/test/specs/xsrf.spec.js b/test/specs/xsrf.spec.js
index 712a8d7..add5afc 100644
--- a/test/specs/xsrf.spec.js
+++ b/test/specs/xsrf.spec.js
@@ -67,7 +67,7 @@ describe('xsrf', function () {
     });
   });
 
-  it('should set xsrf header for cross origin when using withCredentials', function (done) {
+  it('should not set xsrf header for cross origin when using withCredentials', function (done) {
     document.cookie = axios.defaults.xsrfCookieName + '=12345';
 
     axios('http://example.com/', {
@@ -75,7 +75,7 @@ describe('xsrf', function () {
     });
 
     getAjaxRequest().then(function (request) {
-      expect(request.requestHeaders[axios.defaults.xsrfHeaderName]).toEqual('12345');
+      expect(request.requestHeaders[axios.defaults.xsrfHeaderName]).toEqual(undefined);
       done();
     });
   });
-- 
2.39.3

