From 538d9c85320795d9c89223fd48a7a0ec7a67f739 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Thu, 9 Feb 2023 16:52:36 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for glob-parent 3.1.0

This patch fixes:
  CVE-2020-28469

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/gulpjs/glob-parent/tree/v3.1.0
---
 index.js | 2 +-
 test.js  | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/index.js b/index.js
index 3a14a53..1b2c4c1 100644
--- a/index.js
+++ b/index.js
@@ -10,7 +10,7 @@ module.exports = function globParent(str) {
 	if (isWin32 && str.indexOf('/') < 0) str = str.split('\\').join('/');
 
 	// special case for strings ending in enclosure containing path separator
-	if (/[\{\[].*[\/]*.*[\}\]]$/.test(str)) str += '/';
+	if (/[\{\[].*[\}\]]$/.test(str)) str += '/';
 
 	// preserves full path in case of trailing path separator
 	str += 'a';
diff --git a/test.js b/test.js
index 1066922..dcc06f2 100644
--- a/test.js
+++ b/test.js
@@ -169,6 +169,13 @@ describe('glob2base test patterns', function() {
 
     assert.equal(gp('ooga/{booga,sooga}/**/dooga/{eooga,fooga}'), 'ooga');
   });
+
+  it('should not be susceptible to SNYK-JS-GLOBPARENT-1016905', function(done) {
+    // This will time out if susceptible.
+    gp('{' + '/'.repeat(5000));
+
+    done();
+  });
 });
 
 if (isWin32) {
-- 
2.34.1

