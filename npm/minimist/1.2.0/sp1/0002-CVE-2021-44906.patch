From 73c60f49681b3a191972736c6000930be03417ea Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Mon, 21 Aug 2023 17:04:18 +0300
Subject: [PATCH 2/2] Seal Security Hotfix for minimist 1.2.0

This patch fixes:
  CVE-2021-44906

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/minimistjs/minimist/tree/v1.2.0
---
 index.js | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/index.js b/index.js
index 08b579a..1665946 100644
--- a/index.js
+++ b/index.js
@@ -70,7 +70,7 @@ module.exports = function (args, opts) {
         var o = obj;
         for (var i = 0; i < keys.length-1; i++) {
             var key = keys[i];
-            if (key === '__proto__') return;
+            if (isConstructorOrProto(o, key)) return;
             if (o[key] === undefined) o[key] = {};
             if (o[key] === Object.prototype || o[key] === Number.prototype
                 || o[key] === String.prototype) o[key] = {};
@@ -79,7 +79,7 @@ module.exports = function (args, opts) {
         }
 
         var key = keys[keys.length - 1];
-        if (key === '__proto__') return;
+        if (isConstructorOrProto(o, key)) return;
         if (o === Object.prototype || o === Number.prototype
             || o === String.prototype) o = {};
         if (o === Array.prototype) o = [];
@@ -243,3 +243,7 @@ function isNumber (x) {
     return /^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(x);
 }
 
+
+function isConstructorOrProto (obj, key) {
+    return (key === 'constructor' && typeof obj[key] === 'function') || key === '__proto__';
+}
-- 


