From 325af9b756ba2d915e46826837e45c147c70b7f3 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Wed, 20 Sep 2023 15:50:29 +0300
Subject: [PATCH 1/2] Seal Security Hotfix for minimist 0.0.10

This patch fixes:
  CVE-2021-44906

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/minimistjs/minimist/tree/v0.0.10
---
 index.js | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/index.js b/index.js
index 9aed637..1c943d7 100644
--- a/index.js
+++ b/index.js
@@ -164,7 +164,7 @@ function setKey (obj, keys, value) {
     var o = obj;
     for (var i = 0; i < keys.length-1; i++) {
         var key = keys[i];
-        if (key === '__proto__') return;
+        if (isConstructorOrProto(o, key)) return;
         if (o[key] === undefined) o[key] = {};
         if (o[key] === Object.prototype || o[key] === Number.prototype
             || o[key] === String.prototype) o[key] = {};
@@ -173,7 +173,7 @@ function setKey (obj, keys, value) {
     }
     
     var key = keys[keys.length - 1];
-    if (key === '__proto__') return;
+    if (isConstructorOrProto(o, key)) return;
     if (o === Object.prototype || o === Number.prototype
         || o === String.prototype) o = {};
     if (o === Array.prototype) o = [];
@@ -194,3 +194,6 @@ function isNumber (x) {
     return /^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(x);
 }
 
+function isConstructorOrProto (obj, key) {
+    return (key === 'constructor' && typeof obj[key] === 'function') || key === '__proto__';
+}
-- 


