From 4d17520bfa73dcc1d184047f868ebd05b56ffe7f Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Wed, 20 Sep 2023 14:57:15 +0300
Subject: [PATCH 1/2] Seal Security Hotfix for minimist 0.0.8

This patch fixes:
  CVE-2021-44906

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/minimistjs/minimist/tree/v0.0.8
---
 index.js | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/index.js b/index.js
index 5349173..6f0cafc 100644
--- a/index.js
+++ b/index.js
@@ -161,7 +161,7 @@ function setKey (obj, keys, value) {
     var o = obj;
     for (var i = 0; i < keys.length-1; i++) {
         var key = keys[i];
-        if (key === '__proto__') return;
+        if (isConstructorOrProto(o, key)) return;
         if (o[key] === undefined) o[key] = {};
         if (o[key] === Object.prototype || o[key] === Number.prototype
             || o[key] === String.prototype) o[key] = {};
@@ -170,7 +170,7 @@ function setKey (obj, keys, value) {
     }
     
     var key = keys[keys.length - 1];
-    if (key === '__proto__') return;
+    if (isConstructorOrProto(o, key)) return;
     if (o === Object.prototype || o === Number.prototype
         || o === String.prototype) o = {};
     if (o === Array.prototype) o = [];
@@ -194,3 +194,7 @@ function isNumber (x) {
 function longest (xs) {
     return Math.max.apply(null, xs.map(function (x) { return x.length }));
 }
+
+function isConstructorOrProto (obj, key) {
+    return (key === 'constructor' && typeof obj[key] === 'function') || key === '__proto__';
+}
-- 


