From ec4d5d23c5c0a52bf2404576cde241ad1d573566 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Tue, 31 Oct 2023 22:36:48 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for http-cache-semantics 4.1.0

This patch fixes:
  CVE-2022-25881

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/kornelski/http-cache-semantics/tree/v4.1.0
---
 index.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/index.js b/index.js
index 4f6c2f3..39d58a7 100644
--- a/index.js
+++ b/index.js
@@ -79,10 +79,10 @@ function parseCacheControl(header) {
 
     // TODO: When there is more than one value present for a given directive (e.g., two Expires header fields, multiple Cache-Control: max-age directives),
     // the directive's value is considered invalid. Caches are encouraged to consider responses that have invalid freshness information to be stale
-    const parts = header.trim().split(/\s*,\s*/); // TODO: lame parsing
+    const parts = header.trim().split(/,/);
     for (const part of parts) {
-        const [k, v] = part.split(/\s*=\s*/, 2);
-        cc[k] = v === undefined ? true : v.replace(/^"|"$/g, ''); // TODO: lame unquoting
+        const [k, v] = part.split(/=/, 2);
+        cc[k.trim()] = v === undefined ? true : v.trim().replace(/^"|"$/g, '');
     }
 
     return cc;
-- 


