From 580a3b6c8739aa8467aaea4cd58f744ce694399d Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Tue, 31 Oct 2023 11:02:36 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for decode-uri-component 0.2.0

This patch fixes:
  CVE-2022-38900

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/SamVerschueren/decode-uri-component/tree/v0.2.0
---
 index.js | 2 +-
 test.js  | 5 ++++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/index.js b/index.js
index 691499b..75f6839 100644
--- a/index.js
+++ b/index.js
@@ -1,6 +1,6 @@
 'use strict';
 var token = '%[a-f0-9]{2}';
-var singleMatcher = new RegExp(token, 'gi');
+var singleMatcher = new RegExp('(' + token + ')|([^%]+?)', 'gi');
 var multiMatcher = new RegExp('(' + token + ')+', 'gi');
 
 function decodeComponents(components, split) {
diff --git a/test.js b/test.js
index 85adb1d..86fabd5 100644
--- a/test.js
+++ b/test.js
@@ -32,7 +32,10 @@ const tests = {
 	'%C2x': '\uFFFDx',
 	'%C2%B5': 'µ',
 	'%C2%B5%': 'µ%',
-	'%%C2%B5%': '%µ%'
+	'%%C2%B5%': '%µ%',
+	'%ea%ba%5a%ba': '%ea%baZ%ba',
+	'%C3%5A%A5': '%C3Z%A5',
+	'%C3%5A%A5%AB': '%C3Z%A5%AB'
 };
 
 function macro(t, input, expected) {
-- 


