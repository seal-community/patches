From 904b279341f2016d185d5546ab4f7bff9ede9e18 Mon Sep 17 00:00:00 2001
From: Seal <info@seal.security>
Date: Tue, 31 Oct 2023 14:53:56 +0200
Subject: [PATCH 1/1] Seal Security Hotfix for word-wrap 1.2.3

This patch fixes:
  CVE-2023-26115

For more information see:
  1. https://seal.security
  2. https://github.com/seal-community
  3. https://github.com/jonschlinkert/word-wrap/tree/1.2.3
---
 index.js | 19 +++++++++++++++++--
 test.js  |  4 ++++
 2 files changed, 21 insertions(+), 2 deletions(-)

diff --git a/index.js b/index.js
index 45373c6..08f1e41 100644
--- a/index.js
+++ b/index.js
@@ -1,10 +1,25 @@
 /*!
  * word-wrap <https://github.com/jonschlinkert/word-wrap>
  *
- * Copyright (c) 2014-2017, Jon Schlinkert.
+ * Copyright (c) 2014-2023, Jon Schlinkert.
  * Released under the MIT License.
  */
 
+function trimEnd(str) {
+  var lastCharPos = str.length - 1;
+  var lastChar = str[lastCharPos];
+  while(lastChar === ' ' || lastChar === '\t') {
+    lastChar = str[--lastCharPos];
+  }
+  return str.substring(0, lastCharPos + 1);
+}
+
+function trimTabAndSpaces(str) {
+  const lines = str.split('\n');
+  const trimmedLines = lines.map(function(line){ return trimEnd(line); });
+  return trimmedLines.join('\n');
+}
+
 module.exports = function(str, options) {
   options = options || {};
   if (str == null) {
@@ -36,7 +51,7 @@ module.exports = function(str, options) {
   }).join(newline);
 
   if (options.trim === true) {
-    result = result.replace(/[ \t]*$/gm, '');
+    result = trimTabAndSpaces(result);
   }
   return result;
 };
